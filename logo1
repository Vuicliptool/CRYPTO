// --- Cấu hình màu sắc ---
$colors = [
    "\033[31m", "\033[32m", "\033[33m", "\033[34m", "\033[35m", "\033[36m",
    "\033[91m", "\033[92m", "\033[93m", "\033[94m", "\033[95m", "\033[96m"
];
$resetColor = "\033[0m"; // Màu reset

// Lấy ngẫu nhiên 7 màu từ mảng
$randomColors = [];
for ($i = 0; $i < 7; $i++) {
    $randomColors[] = $colors[mt_rand(0, count($colors) - 1)];
}

system('clear');

// --- Hàm chức năng ---

/**
 * Kiểm tra và lấy khóa API dựa trên ngày hiện tại.
 */
function apikey() {
    date_default_timezone_set("Asia/Ho_Chi_Minh");
    $dayOfWeek = date("D");

    // Mảng chứa mật khẩu và link theo ngày
    $dailyData = [
        "Sun" => ["05055Ufcucuf58", "https://upfiles.com/4GlT5f2"],
        "Mon" => ["58686ugxgxuuguxg788", "https://upfiles.com/EGpaGlCv"],
        "Tue" => ["53838ucffuucg3838", "https://upfiles.com/BKxy5Q"],
        "Wed" => ["53838xfxuxfucuggcu2735", "https://upfiles.com/CGR2vXf"],
        "Thu" => ["5275455fcuucufccfu555", "https://upfiles.com/qTY8w47"],
        "Fri" => ["282727fxxfu7272", "https://upfiles.com/pYvtYu6"],
        "Sat" => ["558382ufzufzux5580", "https://upfiles.com/9oz8zZt6"],
    ];

    $password = $dailyData[$dayOfWeek][0] ?? "default_password"; // Sử dụng giá trị mặc định nếu không tìm thấy
    $linkpassword = $dailyData[$dayOfWeek][1] ?? "https://note1s.com/notes/99VTW5"; // Sử dụng giá trị mặc định nếu không tìm thấy

    // Kiểm tra kết nối Internet
    if (@fsockopen("www.google.com", 80) === false) {
        echo "\x1b[1;31mNO CONNECTION\xa";
        die;
    }

    // Xử lý file key
    if (!file_exists("key")) {
        echo "\033[1;32m
    ______                                   _
    | ___ \\                                 | |
    | |_/ /_ _ ___ _____      _____  _ __ __| |
    |  __/ _` / __/ __\\ \\ /\\ / / _ \\| '__/ _` |
    | |  | (_| \\__ \\__ \\\\ V  V / (_) | | | (_| |
    \\_|  \\__,_|___/___/ \\_/\\_/ \\___/|_|  \\__,_|


\n";
        echo "\033[1;33m[\033[1;37m VÌ TOOL HOÀN TOÀN FREE NÊN VIỆC LẤY KEY CỦA BẠN \n\tGIÚP MÌNH KIẾM THÊM MIẾNG CƠM 🥰\033[1;33m]\n\n";

        echo "\033[1;92m=================================================\n";
        echo "\033[0;37mCopy Links:\033[1;35m[\033[1;33m " . $linkpassword . "\033[1;35m ]\n";
        echo "\033[1;92m=================================================\n";

        echo "\033[1;97m ~\033[1;91m[\033[1;35mPASSWORD\033[1;91m] \033[1;97m=> \033[1;90m";
        $key_input = trim(fgets(STDIN));

        if ($password === $key_input) {
            echo "\033[1;92mKey Hợp Lệ\n";
            sleep(3);
            file_put_contents("key", $key_input); // Ghi key vào file
        } else {
            die("\033[1;31mKey Sai Rồi, Vào Link Phía Trên Để Lấy Key");
        }
    } else {
        if ($password !== file_get_contents("key")) {
            echo "Đang Lấy Key...";
            sleep(2);
            unlink("key"); // Xóa file key
        }
    }
}

/**
 * Hiển thị văn bản từng ký tự với độ trễ.
 *
 * @param string $text Văn bản cần hiển thị.
 * @param int $usleep Microseconds để chờ giữa các ký tự.
 */
function typeText($text, $usleep) {
    $characters = str_split($text);
    foreach ($characters as $char) {
        echo $char;
        usleep($usleep);
    }
}

function fast($text) {
    typeText($text, 5000);
}

function fast1($text) {
    typeText($text, 1000);
}

function slow2($text) {
    typeText($text, 3000);
}

/**
 * Lấy thông tin IP từ ip-api.com.
 *
 * @return object|null Đối tượng chứa thông tin IP hoặc null nếu không thành công.
 */
function ipApi() {
    $response = @file_get_contents("http://ip-api.com/json");
    if ($response) {
        $data = json_decode($response);
        if ($data && $data->status === "success") {
            return $data;
        }
    }
    return null;
}

/**
 * Hiển thị logo và thông tin.
 */
function logo() {
    global $colors, $randomColors; // Sử dụng biến global
    system('clear');

    $api = ipApi();
    if ($api) {
        date_default_timezone_set($api->timezone);
        echo str_pad('               ' . $api->city . ', ' . $api->regionName . ', ' . $api->country, 44, " ", STR_PAD_BOTH) . "\n";
    }
    echo '           ' . date("l") . '           ' . date("d/M/Y") . '         ' . date("H:i") . "\n";

    echo fast1("\t\t$randomColors[6]          〚 𝕋𝕆𝕆𝕃 𝔹𝕐 〛            

$randomColors[0]\t██╗   ██╗██╗   ██╗██╗ ██████╗██╗     ██╗██████╗ 
$randomColors[1]\t██║   ██║██║   ██║██║██╔════╝██║     ██║██╔══██╗
$randomColors[2]\t██║   ██║██║   ██║██║██║     ██║     ██║██████╔╝
$randomColors[3]\t╚██╗ ██╔╝██║   ██║██║██║     ██║     ██║██╔═══╝ 
$randomColors[4]\t ╚████╔╝ ╚██████╔╝██║╚██████╗███████╗██║██║     
$randomColors[5]\t  ╚═══╝   ╚═════╝ ╚═╝ ╚═════╝╚══════╝╚═╝╚═╝     

");
    echo slow2($randomColors[0] . "\t╔♫════════════════════════════════════════♫═╗\n");
    echo slow2($randomColors[5] . "          👉YOUTUBE  : VUICLIP-TOOL-TERMUX\n");
    echo slow2($randomColors[6] . "          👉ZALO     : zalo.me/g/gidiwv418\n");
    echo slow2($randomColors[4] . "          👉TELEGRAM : t.me/vuiclip_tool_termux\n");
    echo slow2($randomColors[3] . "          👉Remember to Subscribe to the Channel\n");
    echo slow2($randomColors[0] . "\t╚═♫════════════════════════════════════════♫╝\n\n");

    $highlightBg = "\033[101m\033[1;32m"; // Nền đỏ, chữ xanh lá
    $resetColor = "\033[0m";
    $newLine = "\n";

    // Sử dụng hằng số 'nama_file' nếu nó được định nghĩa
    $fileName = defined('nama_file') ? nama_file : 'UNKNOWN_FILE';

    echo "\t" . $highlightBg . str_pad(strtoupper($fileName), 44, " ", STR_PAD_BOTH) . $resetColor . $newLine . $newLine;
}
